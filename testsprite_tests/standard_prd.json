{
  "meta": {
    "project": "CGL Score Sight",
    "date": "2026-02-15",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "A web app that analyzes exam response sheet HTML URLs (ViewCandResponse / AssessmentQPHTMLMode1), extracts candidate and question data, computes scores for multiple Indian exam types, and displays a detailed bilingual scorecard with download options.",
  "core_goals": [
    "Allow users to submit a response-sheet URL and receive a parsed, scored result with candidate and question-level details",
    "Support 25+ exam types across SSC, Railway, IB, Bank, and Police with configurable scoring rules",
    "Provide bilingual (Hindi/English) question and option display with image/text fallbacks",
    "Offer downloadable exports (response sheet, answer key, quiz mode) in chosen language(s)",
    "Handle common network/CORS and HTML format variations with fallbacks and clear error messages"
  ],
  "features": [
    {
      "name": "Analyze Response Sheet",
      "description": "Input a response-sheet URL, select exam type and language, and initiate analysis which calls the edge function to parse HTML and return a scored result.",
      "user_flows": [
        "Navigate to / -> Select exam category from dropdown (SSC, Railway, IB, Bank, Police) -> Select specific exam type from dropdown -> Select language (Hindi or English) -> Paste response sheet URL in input field -> Click Analyze button to submit -> See loading screen during analysis -> POST /functions/v1/analyze-response-sheet -> View results with candidate info, scores, and question details",
        "Navigate to / -> Select exam category from dropdown -> Select specific exam type from dropdown -> Paste malformed or inaccessible response sheet URL in input field -> Click Analyze button to submit -> See loading screen during analysis -> POST /functions/v1/analyze-response-sheet -> Receive network/CORS or parse error -> Show error message with retry option"
      ]
    },
    {
      "name": "View Scorecard Results",
      "description": "Display the parsed result: candidate info, total score, section breakdown, and question-wise analysis with status badges and language toggle.",
      "user_flows": [
        "Navigate to / -> After analysis, View candidate information card -> View total score summary -> View section-wise breakdown table -> Browse questions by section tabs -> Filter questions by status (correct, wrong, unattempted, bonus) -> Toggle between Hindi and English language for questions -> Click back button to return to input form",
        "Navigate to / -> After analysis, Click language toggle to switch to Hindi -> Some question images/text for Hindi not available -> Show fallback to available language and display unavailable variant notice"
      ]
    },
    {
      "name": "Multi-Exam Support",
      "description": "Allow user to choose from a broad exam configuration set (25+ exam types) so parsing and scoring use the correct exam pattern and section mapping.",
      "user_flows": [
        "Navigate to / -> Select exam category from dropdown -> Select from list of supported exam types (e.g., SSC CGL Tier-I) -> Paste response sheet URL -> Click Analyze -> System applies examConfig for parsing and scoring -> View results computed per selected exam",
        "Navigate to / -> Select wrong or no specific exam type -> Paste response sheet URL -> Click Analyze -> Parse runs with mismatched examConfig -> Show parsing warnings or incorrect section mapping and present message instructing manual exam selection"
      ]
    },
    {
      "name": "Bilingual Question Display",
      "description": "Toggle between Hindi and English question/option displays; prefer image variants when available and fall back to default text or images.",
      "user_flows": [
        "Navigate to / -> After analysis, Toggle language button to switch between Hindi and English -> View question images in selected language -> View option images in selected language",
        "Navigate to / -> After analysis, Toggle language button to switch to Hindi -> Selected language variant not available for some images -> Show fallback image/text and display an unavailable-variant warning"
      ]
    },
    {
      "name": "HTML Parsing (ViewCandResponse & AssessmentQPHTMLMode1)",
      "description": "Server-side edge function detects HTML format, extracts questions/options/answers, detects user selection vs correct answers, and marks bonus questions.",
      "user_flows": [
        "Navigate to / -> Paste ViewCandResponse.aspx or AssessmentQPHTMLMode1 URL in input field -> Click Analyze button to submit -> POST /functions/v1/analyze-response-sheet -> System automatically detects HTML format -> System extracts questions, options, selected and correct answers -> System calculates scores based on exam pattern -> Return parsed data to client",
        "Navigate to / -> Paste valid URL in input field -> Click Analyze button to submit -> POST /functions/v1/analyze-response-sheet -> System attempts CORS proxy fallback chain (r.jina.ai -> allorigins.win -> corsproxy.io -> thingproxy.freeboard.io) -> All proxies fail -> Return fetch error -> Show fetch/parse error with proxy-fallback suggestion"
      ]
    },
    {
      "name": "Download Features (Response Sheet / Answer Key / Quiz Mode)",
      "description": "Generate downloadable HTML exports in selected language(s): full response sheet, clean answer key, or interactive quiz mode.",
      "user_flows": [
        "Navigate to / -> After analysis, Click Download button (Answer Key / Response Sheet / Quiz Mode) -> Open Download Language Dialog -> Select language option (Hindi / English / Bilingual) -> Click Generate Download -> useHtmlGenerator generates HTML -> Browser prompts file download",
        "Navigate to / -> After analysis, Click Download button -> Open Download Language Dialog -> Select language option -> Click Generate Download -> HTML generation fails or network error when embedding images -> Show error toast with retry and option to download partial content"
      ]
    },
    {
      "name": "Filtering & Search",
      "description": "Filter and search the question list by part/section, status (correct/wrong/unattempted/bonus), and language.",
      "user_flows": [
        "Navigate to / -> After analysis, Use Part Filter to select Part A -> Use Status Filter to select Wrong -> See filtered question list update -> Use search to find a question number or keyword -> View filtered results",
        "Navigate to / -> After analysis, Apply combination of filters that yields zero questions -> Show empty state message with suggested actions and Clear Filters button"
      ]
    },
    {
      "name": "Loading Screen & Progress",
      "description": "Provide an animated loading screen with progress indicators while analysis/parsing is in progress and transition smoothly to results.",
      "user_flows": [
        "Navigate to / -> Paste response sheet URL -> Click Analyze -> See LoadingScreen with progress indicators -> Transition to results when parsing completes",
        "Navigate to / -> Paste response sheet URL -> Click Analyze -> See LoadingScreen -> Parsing exceeds timeout or hangs -> Show timeout prompt with Retry and Cancel options"
      ]
    },
    {
      "name": "Candidate Information Extraction",
      "description": "Extract and display candidate fields (roll number, name, exam level, date, shift, centre) from parsed HTML with table/text heuristics.",
      "user_flows": [
        "Navigate to / -> Paste response sheet URL -> Click Analyze -> POST /functions/v1/analyze-response-sheet -> System extracts roll number, name, exam level, test date, shift/time, centre name -> Display candidate info in CandidateInfoCard",
        "Navigate to / -> Paste response sheet URL with missing or unusual candidate table -> Click Analyze -> System fails to extract specific fields -> Display CandidateInfoCard with 'Unknown' placeholders and a parse warning"
      ]
    },
    {
      "name": "Score Calculation & Section Rules",
      "description": "Compute per-question marks and section scores based on examConfig (correctMarks, negativeMarks, qualifying sections) and surface totals/section exclusions.",
      "user_flows": [
        "Navigate to / -> After parsing questions and answers, System applies examConfig scoring rules -> Compute question-level marks and section totals -> Display Total Score and SectionBreakdown with correct/wrong/unattempted/bonus counts",
        "Navigate to / -> After parsing, Exam config mismatch or special qualifying section present -> System flags qualifying section and exclude from total or shows config warning -> Allow user to review examConfig"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "frontend",
    "tech_stack": [
      "TypeScript",
      "React",
      "Vite",
      "TailwindCSS",
      "shadcn/ui",
      "Supabase"
    ],
    "routes": [
      {
        "path": "/",
        "file": "src/pages/Index.tsx",
        "auth_required": false,
        "description": "Main page for analyzing exam response sheets"
      },
      {
        "path": "/*",
        "file": "src/pages/NotFound.tsx",
        "auth_required": false,
        "description": "404 Not Found page"
      }
    ],
    "features": [
      {
        "name": "Analyze Response Sheet",
        "description": "Users can paste a response sheet URL, select exam type and language, then analyze the scorecard",
        "files": [
          "src/pages/Index.tsx",
          "src/components/HeroInput.tsx",
          "src/lib/parseSSCHtml.ts",
          "src/lib/examConfig.ts",
          "supabase/functions/analyze-response-sheet/index.ts"
        ],
        "entry_route": "/",
        "user_interactions": [
          "Select exam category from dropdown (SSC, Railway, IB, Bank, Police)",
          "Select specific exam type from dropdown",
          "Select language (Hindi or English)",
          "Paste response sheet URL in input field",
          "Click Analyze button to submit",
          "View loading screen during analysis",
          "View results with candidate info, scores, and question details"
        ],
        "api_calls": [
          {
            "method": "POST",
            "endpoint": "/functions/v1/analyze-response-sheet"
          }
        ],
        "auth_required": false
      },
      {
        "name": "View Scorecard Results",
        "description": "Display detailed scorecard with candidate info, section breakdown, and question-wise analysis",
        "files": [
          "src/pages/Index.tsx",
          "src/components/ResultsHeader.tsx",
          "src/components/CandidateInfoCard.tsx",
          "src/components/TotalScoreCard.tsx",
          "src/components/SectionBreakdown.tsx",
          "src/components/QuestionAnalysis.tsx",
          "src/components/QuestionDetail.tsx"
        ],
        "entry_route": "/",
        "user_interactions": [
          "View candidate information card",
          "View total score summary",
          "View section-wise breakdown table",
          "Browse questions by section tabs",
          "Filter questions by status (correct, wrong, unattempted, bonus)",
          "Toggle between Hindi and English language for questions",
          "Click back button to return to input form"
        ],
        "api_calls": [],
        "auth_required": false
      },
      {
        "name": "Multi-Exam Support",
        "description": "Support for 25+ exam types across SSC, Railway, IB, Bank, and Police categories",
        "files": [
          "src/lib/examConfig.ts"
        ],
        "entry_route": "/",
        "user_interactions": [
          "Select from SSC exams (CGL Tier-I/II, CHSL, CPO, MTS, GD Constable, Steno)",
          "Select from Railway exams (RRB NTPC, Group D, JE, ALP)",
          "Select from IB exams (ACIO, Security Assistant)",
          "Select from Bank exams (IBPS PO/Clerk, SBI PO/Clerk)",
          "Select from Police exams (Delhi Police Constable/Head Constable)"
        ],
        "api_calls": [],
        "auth_required": false
      },
      {
        "name": "Bilingual Question Display",
        "description": "Display questions and options in Hindi or English with language toggle",
        "files": [
          "src/components/QuestionAnalysis.tsx",
          "src/components/QuestionDetail.tsx",
          "src/lib/parseSSCHtml.ts"
        ],
        "entry_route": "/",
        "user_interactions": [
          "Toggle language button to switch between Hindi and English",
          "View question images in selected language",
          "View option images in selected language"
        ],
        "api_calls": [],
        "auth_required": false
      },
      {
        "name": "HTML Parsing",
        "description": "Parse two different HTML formats - ViewCandResponse and AssessmentQPHTMLMode1",
        "files": [
          "src/lib/parseSSCHtml.ts",
          "supabase/functions/analyze-response-sheet/index.ts"
        ],
        "entry_route": "/",
        "user_interactions": [
          "System automatically detects HTML format",
          "System extracts questions, options, and answers",
          "System calculates scores based on exam pattern"
        ],
        "api_calls": [
          {
            "method": "POST",
            "endpoint": "/functions/v1/analyze-response-sheet"
          }
        ],
        "auth_required": false
      }
    ],
    "known_limitations": [
      {
        "issue": "CORS proxy fallback chain may fail for some URLs",
        "location": "supabase/functions/analyze-response-sheet/index.ts",
        "impact": "URL fetching may fail if all proxies are unavailable"
      },
      {
        "issue": "Exam config must be manually selected, not auto-detected from URL",
        "location": "src/components/HeroInput.tsx",
        "impact": "Users must know their exam type to select correctly"
      },
      {
        "issue": "Text extraction with line breaks is newly implemented and may need testing",
        "location": "src/lib/parseSSCHtml.ts",
        "impact": "Option text formatting may not be perfect for all HTML structures"
      }
    ]
  }
}
